# F2: 아티스트 검색 & RAG - 화면 구조 (Screens)

## 화면 목록

| 화면 | 라우트 | 설명 |
|------|--------|------|
| 검색 홈 | `/(tabs)/search` | 검색창, 최근 검색, 인기 아티스트, 내 아티스트 |
| 검색 결과 | `/(tabs)/search?q={검색어}` | RAG 검색 결과 목록, 카테고리 필터 (URL로 딥링크/공유 가능) |
| 아티스트 프로필 | `/(tabs)/search/artist/[id]` | 아티스트 행사 목록 (탭 바 유지) |
| 행사 상세 | `/(tabs)/search/event/[id]` | 행사 상세 정보 (탭 바 유지) |

> **탭 내 스택 네비게이션**: 검색 탭 내에서 아티스트/행사 상세로 이동해도 하단 탭 바가 유지됩니다.

---

## 1. 검색 홈

**라우트**: `/(tabs)/search`
**용도**: 아티스트/행사 검색 진입점, 빠른 접근 제공

### UI 요소 - 기본 상태

```
┌─────────────────────────────────┐
│  검색                            │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │ 🔍 아티스트 또는 행사 검색  │   │
│  └─────────────────────────┘   │
│                                 │
│  최근 검색                [전체삭제]│
│  ┌──────┐ ┌──────┐ ┌──────┐   │
│  │ BTS  │ │aespa │ │NewJ  │   │
│  └──────┘ └──────┘ └──────┘   │
│                                 │
│  내 아티스트                     │
│  ┌─────┐ ┌─────┐ ┌─────┐ ──▶  │
│  │ 🎤  │ │ 🎤  │ │ 🎤  │      │
│  │ BTS │ │ IU  │ │BLPK │      │
│  └─────┘ └─────┘ └─────┘      │
│                                 │
│  인기 아티스트                   │
│  ┌─────┐ ┌─────┐ ┌─────┐      │
│  │ 🎤  │ │ 🎤  │ │ 🎤  │      │
│  │NewJ │ │aespa│ │ SVT │      │
│  └─────┘ └─────┘ └─────┘      │
│  ┌─────┐ ┌─────┐ ┌─────┐      │
│  │ 🎤  │ │ 🎤  │ │ 🎤  │      │
│  │ATEEZ│ │STRAY│ │LE SS│      │
│  └─────┘ └─────┘ └─────┘      │
│                                 │
└─────────────────────────────────┘
```

| 요소 | 타입 | 액션 |
|------|------|------|
| 헤더 | Text (H1) | "검색" |
| 검색 입력창 | TextInput | 탭 시 포커스, 자동완성 모드 진입 |
| 최근 검색 섹션 제목 | Text (H3) + TextButton | "전체삭제" 탭 시 최근 검색 삭제 |
| 최근 검색 칩 | Chip (removable) | 탭 시 해당 검색어로 RAG 검색 실행 (서버 동기화) |
| 내 아티스트 섹션 | HorizontalScrollView | 팔로우 중인 아티스트 가로 스크롤 |
| 내 아티스트 카드 | ArtistCard (Small) | 탭 시 아티스트 프로필로 이동 |
| 인기 아티스트 그리드 | Grid (3열) | MVP에서는 하드코딩, 향후 팔로워 수 기반 집계 |
| 인기 아티스트 카드 | ArtistCard (Medium) | 탭 시 아티스트 프로필로 이동 |

### UI 요소 - 자동완성 상태

```
┌─────────────────────────────────┐
│  ← 검색                         │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │ 🔍 BTS                  ×│   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │ 🌐 "BTS" 웹에서 검색     │   │
│  │    최신 행사 정보를 찾습니다│   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │  🎤 BTS (방탄소년단)      │   │
│  │     K-POP · 그룹          │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │  🎤 BTS 지민              │   │
│  │     K-POP · 솔로          │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │  🎤 BTS 정국              │   │
│  │     K-POP · 솔로          │   │
│  └─────────────────────────┘   │
│                                 │
└─────────────────────────────────┘
```

| 요소 | 타입 | 액션 |
|------|------|------|
| 뒤로가기 | IconButton (←) | 자동완성 모드 종료, 검색 홈으로 복귀 |
| 검색 입력창 | TextInput (활성) | 텍스트 입력 시 자동완성 갱신 |
| 지우기 버튼 | IconButton (×) | 검색어 초기화 |
| "웹에서 검색" 옵션 | ListItem (2줄: 제목 + 부제) | "🌐 {검색어} 웹에서 검색 / 최신 행사 정보를 찾습니다" 탭 시 RAG 검색 실행, URL: `?q={검색어}` |
| 아티스트 자동완성 항목 | ListItem (이미지 + 이름 + 장르) | 탭 시 아티스트 프로필로 이동 |

### 상태

- **기본**: 최근 검색, 내 아티스트, 인기 아티스트 표시
- **자동완성 모드**: 검색창 포커스 시 전환, 자동완성 드롭다운 표시
- **자동완성 로딩**: 자동완성 영역에 스피너
- **자동완성 결과 없음**: "일치하는 아티스트가 없습니다" + "웹에서 검색" 옵션 유지
- **최근 검색 없음**: "최근 검색" 섹션 숨김
- **내 아티스트 없음**: "내 아티스트" 섹션 숨김
- **에러**: "검색에 실패했습니다. 다시 시도해주세요." 토스트

---

## 2. 검색 결과

**라우트**: `/(tabs)/search?q={검색어}` (딥링크/공유 가능)
**용도**: RAG 검색 결과를 카테고리별로 표시

> **무한 스크롤**: 초기 20건 로드, 스크롤 시 추가 로드 (search_id 패턴 사용)

### UI 요소

```
┌─────────────────────────────────┐
│  ← 검색                         │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │ 🔍 BTS                  ×│   │
│  └─────────────────────────┘   │
│                                 │
│  12건 · 0.8초  [캐시됨]         │
│                                 │
│  ┌──────┬──────┬──────┬──────┐ │
│  │ 전체 │콘서트│팬미팅│ 방송 │ │
│  └──────┴──────┴──────┴──────┘ │
│                                 │
│  ┌─────────────────────────┐   │
│  │  🎵 BTS WORLD TOUR      │   │
│  │  📅 2026.03.15 (토)      │   │
│  │  📍 서울 올림픽 체조경기장  │   │
│  │  [콘서트]                 │   │
│  │  출처: ticketlink.co.kr  │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │  🎵 BTS 지민 팬미팅      │   │
│  │  📅 2026.04.01 (수)      │   │
│  │  📍 서울 YES24 라이브홀   │   │
│  │  [팬미팅]                 │   │
│  │  출처: melon.com         │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │  🎵 BTS 정국 - 음악방송   │   │
│  │  📅 2026.03.20 (목)      │   │
│  │  📍 SBS 인기가요          │   │
│  │  [방송]                   │   │
│  │  출처: sbs.co.kr         │   │
│  └─────────────────────────┘   │
│                                 │
│  관련 아티스트                   │
│  ┌─────┐ ┌─────┐ ┌─────┐ ──▶  │
│  │ 🎤  │ │ 🎤  │ │ 🎤  │      │
│  │지민  │ │정국  │ │ RM  │      │
│  └─────┘ └─────┘ └─────┘      │
│                                 │
└─────────────────────────────────┘
```

| 요소 | 타입 | 액션 |
|------|------|------|
| 뒤로가기 | IconButton (←) | 검색 홈으로 복귀 |
| 검색 입력창 | TextInput (검색어 표시) | 탭 시 자동완성 모드로 전환 |
| 결과 요약 | Text (Caption) | "N건 · X.Xs" 형식 |
| 캐시 뱃지 | Badge | 캐시된 결과인 경우 "캐시됨" 표시 |
| 카테고리 필터 탭 | TabBar | 전체 / 콘서트 / 팬미팅 / 방송 / 페스티벌 |
| 행사 카드 | Card | 탭 시 행사 상세로 이동 |
| 행사 카드 - 행사명 | Text (H3) | - |
| 행사 카드 - 날짜 | Text (Body) + Icon (📅) | - |
| 행사 카드 - 장소 | Text (Body) + Icon (📍) | - |
| 행사 카드 - 카테고리 | Badge | 콘서트/팬미팅/방송/페스티벌 |
| 행사 카드 - 출처 | Text (Small, Gray) | 정보 출처 도메인 |
| 관련 아티스트 | HorizontalScrollView | 장르/소속사 기반 매칭 (MVP), 최대 6명 |
| 관련 아티스트 카드 | ArtistCard (Small) | 탭 시 아티스트 프로필로 이동 |

### 상태

- **RAG 검색 중**: 스켈레톤 카드 (3-4개) + "행사 정보를 검색하고 있습니다..." 텍스트
- **결과 있음**: 행사 카드 리스트 + 결과 요약 + 카테고리 필터
- **결과 없음**: Empty State 아이콘 + "행사 정보를 찾을 수 없습니다" + "다른 검색어를 시도해보세요" 텍스트
- **검색 타임아웃**: "검색에 시간이 오래 걸리고 있습니다" + 재시도 버튼
- **에러**: "검색에 실패했습니다" + 재시도 버튼

---

## 3. 아티스트 프로필

**라우트**: `/(tabs)/search/artist/[id]` (탭 바 유지)
**용도**: 아티스트 행사 목록 표시

### UI 요소

```
┌─────────────────────────────────┐
│  ←                              │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │    [아티스트 이미지]      │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│  BTS (방탄소년단)               │
│  K-POP · 그룹                   │
│                                 │
│  ┌─────────────────────────┐   │
│  │     ♥ 팔로우하기          │   │
│  └─────────────────────────┘   │
│  팔로워 1,234명                 │
│                                 │
│  예정된 행사 (5)                │
│                                 │
│  ┌─────────────────────────┐   │
│  │  🎵 WORLD TOUR 서울      │   │
│  │  📅 2026.03.15 (토)      │   │
│  │  📍 올림픽 체조경기장      │   │
│  │  [콘서트]                 │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │  🎵 팬미팅 MAGIC SHOP    │   │
│  │  📅 2026.04.01 (수)      │   │
│  │  📍 YES24 라이브홀        │   │
│  │  [팬미팅]                 │   │
│  └─────────────────────────┘   │
│                                 │
│  지난 행사 보기 ▼               │
│                                 │
└─────────────────────────────────┘
```

| 요소 | 타입 | 액션 |
|------|------|------|
| 뒤로가기 | IconButton (←) | 이전 화면으로 |
| 아티스트 이미지 | Image (Large) | - |
| 아티스트 이름 | Text (H1) | - |
| 장르 태그 | Badge | K-POP, J-POP, Pop 등 |
| 팔로우 버튼 | Button (Primary/Outline) | 팔로우/언팔로우 토글 |
| 팔로워 수 | Text (Caption) | - |
| 예정 행사 카운트 | Text (H3) | "예정된 행사 (N)" |
| 행사 카드 | Card | 탭 시 행사 상세로 이동 |
| 지난 행사 토글 | TextButton | 탭 시 지난 행사 리스트 확장 |
| 관련 아티스트 | HorizontalScrollView | 장르/소속사 기반 매칭 (MVP), 최대 6명 |

### 상태

- **로딩 중**: 헤더 영역 스켈레톤 + 행사 리스트 스켈레톤
- **행사 없음**: "예정된 행사가 없습니다" + 🔔 아이콘 + "알림을 설정하면 새 행사를 알려드려요"
- **에러**: "아티스트 정보를 불러올 수 없습니다" + 재시도 버튼
- **팔로우 중**: 팔로우 버튼 → "팔로우 중" (Outline 스타일)
- **팔로우 해제**: 팔로우 버튼 → "팔로우하기" (Primary 스타일)
- **팔로우 변경 성공**: "팔로우했습니다" / "팔로우를 해제했습니다" 토스트

---

## 4. 행사 상세

**라우트**: `/(tabs)/search/event/[id]` (탭 바 유지)
**용도**: 행사의 모든 상세 정보 표시

### UI 요소

```
┌─────────────────────────────────┐
│  ←                        ···  │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │   [행사 포스터/이미지]    │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│  BTS WORLD TOUR               │
│  [콘서트]                      │
│                                 │
│  🎤 BTS (방탄소년단)        ▶  │
│                                 │
│  ─────────────────────────────  │
│                                 │
│  📅 날짜                       │
│     2026년 3월 15일 (토)       │
│     오후 6:00 (KST)           │
│                                 │
│  📍 장소                       │
│     서울 올림픽 체조경기장       │
│     서울특별시 송파구 올림픽로 424│
│                                 │
│  💰 가격                       │
│     VIP: ₩198,000             │
│     R석: ₩154,000             │
│     S석: ₩110,000             │
│                                 │
│  ─────────────────────────────  │
│                                 │
│  ┌─────────────────────────┐   │
│  │   🎫 티켓 예매하기        │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌───────────┐ ┌───────────┐   │
│  │📅 캘린더   │ │🔔 알림     │   │
│  │   추가     │ │   설정     │   │
│  └───────────┘ └───────────┘   │
│                                 │
│  ─────────────────────────────  │
│                                 │
│  ℹ️ 정보 출처                   │
│  ticketlink.co.kr              │
│  수집일: 2026.02.05            │
│                                 │
└─────────────────────────────────┘
```

| 요소 | 타입 | 액션 |
|------|------|------|
| 뒤로가기 | IconButton (←) | 이전 화면으로 |
| 더보기 | IconButton (···) | 공유, 신고 메뉴 |
| 행사 포스터 | Image (Hero) | 있는 경우만 표시 |
| 행사명 | Text (H1) | - |
| 카테고리 뱃지 | Badge | 콘서트/팬미팅/방송/페스티벌 |
| 아티스트 링크 | ListItem (탭 가능) | 탭 시 아티스트 프로필로 이동 |
| 날짜/시간 | Text (Body) + Icon (📅) | 로컬 타임존으로 표시 |
| 장소/주소 | Text (Body) + Icon (📍) | - |
| 가격 정보 | Text (Body) + Icon (💰) | 있는 경우만 표시 |
| 티켓 예매 버튼 | Button (Primary, **disabled**) | F5에서 완성. 탭 시 "곧 지원 예정입니다" 토스트 |
| 캘린더 추가 버튼 | Button (Outline, Half, **disabled**) | F3에서 완성. 탭 시 "곧 지원 예정입니다" 토스트 |
| 알림 설정 버튼 | Button (Outline, Half, **disabled**) | F4에서 완성. 탭 시 "곧 지원 예정입니다" 토스트 |
| 정보 출처 | Text (Small, Gray) | 출처 도메인 + 수집 일시 |

### 상태

- **로딩 중**: 스켈레톤 UI (이미지 + 텍스트 블록)
- **이미지 없음**: 포스터 영역 숨김, 텍스트만 표시
- **가격 정보 없음**: 가격 섹션 숨김
- **티켓 링크 없음**: "티켓 예매하기" 버튼 비활성화 + "예매 정보 없음" 텍스트
- **에러**: "행사 정보를 불러올 수 없습니다" + 재시도 버튼

---

## 5. 공통 컴포넌트

> **ArtistSearchInput**: F1 아티스트 검색 모달과 F2 자동완성에서 재사용하는 공통 컴포넌트.
> Props: `onSelect(artist)`, `placeholder`, `showRecentSearches`, `mode: 'modal' | 'inline'`

### EventCard (행사 카드)

검색 결과, 아티스트 프로필에서 재사용:

```
┌─────────────────────────────┐
│  🎵 행사명                   │
│  📅 2026.03.15 (토)         │
│  📍 서울 올림픽 체조경기장    │
│  [콘서트]     출처: site.com │
└─────────────────────────────┘
```

- 행사명 (H3)
- 날짜 (Body + 📅)
- 장소 (Body + 📍)
- 카테고리 뱃지
- 출처 (Small, Gray)

### ArtistCard (아티스트 카드)

검색 홈, 검색 결과, 아티스트 프로필에서 재사용:

**Small (가로 스크롤용)**:
```
┌─────┐
│ 🎤  │
│ BTS │
└─────┘
```

**Medium (그리드용)**:
```
┌─────────┐
│   🎤    │
│   BTS   │
│  K-POP  │
└─────────┘
```

### CategoryBadge (카테고리 뱃지)

| 카테고리 | 색상 | 텍스트 |
|---------|------|--------|
| 콘서트 | Primary (#007AFF) | 콘서트 |
| 팬미팅 | Info (#5856D6) | 팬미팅 |
| 방송 | Success (#34C759) | 방송 |
| 페스티벌 | Warning (#FF9500) | 페스티벌 |

---

## 6. AC ↔ 화면 매핑

| AC ID | 검증 화면 | 검증 방법 |
|-------|----------|----------|
| AC-F2-01 | 검색 홈 → 검색 결과 (`?q=BTS`) | 아티스트 이름 입력 → 결과 반환 5초 이내 (캐시 시 즉시, 결과 요약에 소요 시간 표시) |
| AC-F2-02 | 검색 결과, 행사 상세 | EventCard에 행사명/날짜/장소/카테고리 표시, 탭 시 행사 상세 확인 |
| AC-F2-03 | 검색 결과 | 동일 검색어 재검색 시 "캐시됨" 뱃지, 즉시 반환 |
| US-4 AC-1 | 검색 결과 | EventCard에 출처 도메인 표시, 행사 상세에 수집일 표시 |
| US-4 AC-2 | 검색 결과 | 카테고리 필터 탭: 전체/콘서트/팬미팅/방송/페스티벌 |
| US-4 AC-3 | 검색 결과 | "캐시됨" 뱃지 표시 |
