# F3: 행사 캘린더 - 화면 구조 (Screens)

## 1. 화면 계층 구조

```
(tabs)/
└── calendar/
    ├── _layout.tsx          # 캘린더 탭 스택 레이아웃
    ├── index.tsx             # 캘린더 메인 (월간/주간/일간 뷰)
    └── event/
        └── [id].tsx          # 행사 상세 (모달 또는 페이지)
```

---

## 2. 화면별 상세 스펙

### 2.1 캘린더 메인 (`/(tabs)/calendar`)

**목적**: 팔로우 아티스트의 행사를 캘린더 형식으로 확인

#### 헤더 영역
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 월/년 표시 | "2026년 3월" | 탭 → 날짜 선택 다이얼로그 |
| 이전/다음 버튼 | ◀ ▶ | 탭 → 이전/다음 월/주/일 이동 |
| 뷰 모드 토글 | [월] [주] [일] | 탭 → 뷰 모드 전환 |
| 필터 아이콘 | 🔍 | 탭 → 필터 바텀시트 열기 |
| 오늘 버튼 | "오늘" | 탭 → 오늘 날짜로 이동 |

#### 캘린더 영역 (월간 뷰)
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 요일 헤더 | 일 월 화 수 목 금 토 | - |
| 날짜 셀 | 1-31 | 탭 → 해당 날짜 선택, 하단에 행사 표시 |
| 오늘 마커 | 오늘 날짜 원형 배경 | - |
| 행사 도트 | 날짜 아래 색상 도트 | - (아티스트별 색상) |
| 선택 마커 | 선택된 날짜 테두리 | - |

#### 캘린더 영역 (주간 뷰)
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 요일 + 날짜 헤더 | "월 10" | 탭 → 해당 날짜 선택 |
| 행사 블록 | 행사 제목 (축약) | 탭 → 행사 상세 |
| 타임라인 | 시간대별 그리드 | 스크롤 |

#### 캘린더 영역 (일간 뷰)
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 날짜 표시 | "3월 15일 (토)" | 좌우 스와이프 → 날짜 이동 |
| 행사 수 | "2개 행사" | - |
| 타임라인 행사 | 시간 + 행사 카드 | 탭 → 행사 상세 |

#### 하단 행사 목록 (월간 뷰)
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 날짜 헤더 | "3월 15일 (토)" | - |
| 행사 카드 | EventCard 컴포넌트 재사용 | 탭 → 행사 상세 |
| 더보기 | 3개 이상일 때 | 탭 → 일간 뷰로 전환 |

#### 상태 표시
| 상태 | 표시 |
|------|------|
| 로딩 | 스켈레톤 UI (캘린더 그리드 형태) |
| 행사 없음 | Empty State + 메시지 |
| 팔로우 없음 | Empty State + "아티스트 찾기" 버튼 |
| 에러 | Error State + 재시도 버튼 |

---

### 2.2 필터 바텀시트

**목적**: 아티스트별 필터 적용

#### 컨텐츠
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 타이틀 | "아티스트 필터" | - |
| 전체 선택 | "전체 선택 / 해제" | 탭 → 전체 토글 |
| 아티스트 목록 | 팔로우 아티스트 리스트 | - |
| 아티스트 항목 | 프로필 이미지 + 이름 + 체크박스 | 탭 → 선택/해제 |
| 적용 버튼 | "적용" (Primary) | 탭 → 필터 적용, 바텀시트 닫기 |
| 초기화 버튼 | "초기화" (Secondary) | 탭 → 전체 선택 |

#### 레이아웃
```
┌──────────────────────────────────────────┐
│ ────────────────                         │ ← 드래그 핸들
│                                          │
│  아티스트 필터                            │
│                                          │
│  [✓] 전체 선택                           │
│  ─────────────────────────────────       │
│  ┌────┐                                  │
│  │ 🖼️ │ BTS               [✓]          │
│  └────┘                                  │
│  ┌────┐                                  │
│  │ 🖼️ │ NewJeans          [✓]          │
│  └────┘                                  │
│  ┌────┐                                  │
│  │ 🖼️ │ aespa             [ ]          │
│  └────┘                                  │
│                                          │
│  ┌─────────────┐  ┌─────────────────┐   │
│  │   초기화    │  │      적용       │   │
│  └─────────────┘  └─────────────────┘   │
└──────────────────────────────────────────┘
```

---

### 2.3 행사 상세 (`/(tabs)/calendar/event/[id]`)

**목적**: 행사 상세 정보 확인 및 액션 수행

> 참고: 검색 탭의 행사 상세 화면 재사용 (`/(tabs)/search/event/[id]`)
> 동일한 컴포넌트를 사용하되, 뒤로가기 시 캘린더로 복귀

#### 헤더 영역
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 뒤로가기 | ← | 탭 → 캘린더로 복귀 |
| 타이틀 | "행사 상세" | - |
| 공유 | 📤 | 탭 → 시스템 공유 시트 |

#### 컨텐츠 영역
| 요소 | 설명 |
|------|------|
| 행사 이미지 | 대형 이미지 (있는 경우) |
| 카테고리 뱃지 | 콘서트 / 팬미팅 / 방송 / 페스티벌 |
| 행사명 | 큰 폰트 |
| 아티스트 | 아티스트 이름 + 탭 → 프로필 이동 |
| 날짜/시간 | 📅 2026년 3월 15일 (토) 18:00 |
| 장소 | 📍 서울 올림픽 체조경기장 + 탭 → 지도 앱 |
| 가격 | 💰 110,000원 ~ 198,000원 |
| 가격 상세 | VIP: 198,000원, R석: 154,000원, S석: 110,000원 |
| 정보 출처 | 📎 ticketlink.co.kr + 탭 → 외부 브라우저 |

#### 액션 영역
| 요소 | 설명 | 인터랙션 |
|------|------|----------|
| 캘린더 추가 | "📅 캘린더에 추가" | 탭 → 로컬 캘린더 이벤트 생성 |
| 예매하기 | "🎫 예매하기" (Primary, 활성 시) | 탭 → 외부 브라우저에서 예매 페이지 |
| 예매하기 (비활성) | 예매 URL 없을 때 | 비활성 상태, "예매 정보 없음" 표시 |

---

## 3. 컴포넌트 정의

### 3.1 새로 만들 컴포넌트

| 컴포넌트 | 위치 | 설명 |
|----------|------|------|
| `CalendarView` | `components/calendar/CalendarView.tsx` | 월간/주간/일간 뷰 통합 |
| `MonthView` | `components/calendar/MonthView.tsx` | 월간 캘린더 그리드 |
| `WeekView` | `components/calendar/WeekView.tsx` | 주간 캘린더 뷰 |
| `DayView` | `components/calendar/DayView.tsx` | 일간 타임라인 뷰 |
| `CalendarHeader` | `components/calendar/CalendarHeader.tsx` | 캘린더 헤더 (날짜, 모드 토글) |
| `DayCell` | `components/calendar/DayCell.tsx` | 날짜 셀 (도트 포함) |
| `EventDot` | `components/calendar/EventDot.tsx` | 행사 표시 도트 |
| `DayEventList` | `components/calendar/DayEventList.tsx` | 선택된 날짜의 행사 목록 |
| `ArtistFilterSheet` | `components/calendar/ArtistFilterSheet.tsx` | 아티스트 필터 바텀시트 |
| `ArtistFilterItem` | `components/calendar/ArtistFilterItem.tsx` | 필터 목록 항목 |

### 3.2 재사용할 기존 컴포넌트

| 컴포넌트 | 원본 위치 | 용도 |
|----------|----------|------|
| `EventCard` | `components/search/EventCard.tsx` | 행사 카드 표시 |
| `CategoryBadge` | `components/search/CategoryBadge.tsx` | 카테고리 뱃지 |
| `Button` | `components/common/Button.tsx` | 버튼 |

---

## 4. 스타일 가이드

### 4.1 캘린더 색상

| 요소 | 색상 | 설명 |
|------|------|------|
| 오늘 날짜 배경 | `Primary (#007AFF)` | 원형 배경 |
| 선택된 날짜 테두리 | `Primary (#007AFF)` | 원형 테두리 |
| 휴일 텍스트 | `Error (#FF3B30)` | 일요일 |
| 토요일 텍스트 | `Info (#5856D6)` | 토요일 |
| 행사 도트 | 카테고리별 색상 | 아래 참조 |

### 4.2 카테고리별 도트 색상

| 카테고리 | 색상 | Hex |
|----------|------|-----|
| 콘서트 | Primary Blue | `#007AFF` |
| 팬미팅 | Purple | `#5856D6` |
| 방송 | Green | `#34C759` |
| 페스티벌 | Orange | `#FF9500` |

### 4.3 캘린더 레이아웃

| 속성 | 값 |
|------|-----|
| 셀 크기 (월간) | 화면 너비 / 7 |
| 셀 높이 (월간) | 48px (도트 포함) |
| 주간 시간 그리드 높이 | 60px/시간 |
| 도트 크기 | 6px |
| 도트 간격 | 2px |
| 도트 최대 | 3개 (초과 시 "+N" 표시) |

---

## 5. 인터랙션 & 제스처

### 5.1 캘린더 제스처

| 제스처 | 뷰 모드 | 액션 |
|--------|---------|------|
| 좌우 스와이프 | 월간 | 이전/다음 월 이동 |
| 좌우 스와이프 | 주간 | 이전/다음 주 이동 |
| 좌우 스와이프 | 일간 | 이전/다음 일 이동 |
| 핀치 줌아웃 | 주간/일간 | 월간 뷰로 전환 |
| 핀치 줌인 | 월간/주간 | 다음 상세 뷰로 전환 |
| 날짜 탭 | 월간 | 날짜 선택, 하단 목록 갱신 |
| 날짜 길게 누르기 | 모든 뷰 | 일간 뷰로 이동 |

### 5.2 바텀시트 제스처

| 제스처 | 액션 |
|--------|------|
| 드래그 핸들 아래로 | 닫기 |
| 배경 탭 | 닫기 |
| 스크롤 | 아티스트 목록 스크롤 |

### 5.3 애니메이션

| 전환 | 애니메이션 |
|------|------------|
| 월/주/일 전환 | 페이드 + 스케일 (300ms) |
| 날짜 이동 | 슬라이드 (200ms) |
| 바텀시트 열기 | 스프링 업 (400ms) |
| 행사 목록 표시 | 페이드인 + 슬라이드업 (200ms) |

---

## 6. 데이터 요구사항

### 6.1 캘린더 데이터 로드

```typescript
// GET /api/v1/events
interface CalendarEventsRequest {
  from_date: string;  // "2026-03-01"
  to_date: string;    // "2026-03-31"
  artist_ids?: string[];  // 필터 적용 시
}

interface CalendarEventsResponse {
  data: Event[];
  total: number;
}
```

### 6.2 로컬 캘린더 추가

```typescript
import * as Calendar from 'expo-calendar';

interface AddToCalendarData {
  title: string;
  startDate: Date;
  endDate: Date;
  location: string;
  notes: string;
  url: string;
}
```

---

## 7. 접근성

| 항목 | 구현 |
|------|------|
| 날짜 셀 | `accessibilityLabel="3월 15일 토요일, 행사 2개"` |
| 뷰 모드 토글 | `accessibilityRole="button"`, `accessibilityState={selected}` |
| 행사 도트 | `accessibilityLabel="콘서트 1개, 팬미팅 1개"` |
| 스와이프 힌트 | `accessibilityHint="좌우로 스와이프하여 월 이동"` |
